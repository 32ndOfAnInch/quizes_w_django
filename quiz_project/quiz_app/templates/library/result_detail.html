{% extends 'base.html' %}

{% block content %}
    <h1>Quiz result</h1>
    <div class="results-header">
    <h2>{{ object.quiz.name }}</h2>
    <h3>{{ object.user.username }}</h3>
    {% if object.score >= object.quiz.score_to_pass %}
        <div class="passed-test">
        <p>Congratulations! You have passed the quiz!</p>
        </div>
    {% else %}
        <div class="failed-test">
        <p>Unfortunately, you have failed to pass the quiz..</p>
        </div>
    {% endif %}
    <h4>Your score: {{ object.score }}%</h4>
    <h4>Required score to pass: {{ object.quiz.score_to_pass }}%</h4>
    </div>
    <br>
    <h3>Correctly answered questions:</h3>
    <ul>
    {% for question in object.questions_attempted.all %}
        <li>
        <p>Question: {{ question.text|safe }}</p>
        <p>Answer:
          {% for answer in object.user_answers.all %}
            {% if answer.question == question %}
              {{ answer.text }} &#9989;
            {% endif %}
          {% endfor %}
        </p>
        </li>
        <hr>
    {% endfor %}
    </ul>
<br>
<h3>Unanswered or incorrectly answered questions:</h3>
    <ul>
    {% for question in object.quiz.questions.all %}
        {% if question not in object.questions_attempted.all %}
            <li>
                <p>Question: {{ question.text|safe }}</p>
                <p>Correct answer:
                {% for answer in question.answers.all %}
                    {% if answer.correct %}
                        {{ answer.text }}
                    {% endif %}
                {% endfor %}
                </p>
            <p>Your answer:
                {% for answer in object.user_incorrect_answers.all %}
                    {% if answer.question == question %}
                        {{ answer.text }} &#10060;
                    {% comment %} elif logic when question was unanswered {% endcomment %}
                    {% endif %}
                {% endfor %}
            </p>
            </li>
        <hr>
        {% endif %}
    {% endfor %}
    </ul>
  
{% endblock content %}