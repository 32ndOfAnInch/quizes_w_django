{% extends 'base.html' %}

{% block content %}
  <h1>Quiz Result</h1>
  <h2>{{ object.quiz.name }}</h2>
  <p>{{ object.user.username }}</p>
  {% if object.score >= object.quiz.score_to_pass %}
  <p>Congratulations! You have passed the quiz!</p>
  {% else %}
  <p>Unfortunately, you have failed to pass the quiz..</p>
  {% endif %}
  <p>Your score: {{ object.score }}%</p>
  <p>Required score to pass: {{ object.quiz.score_to_pass }}%</p>
    <br>
  <h3>Correctly answered questions:</h3>
  <ul>
    {% for question in object.questions_attempted.all %}
      <li>
        <p>Question: {{ question.text|safe }}</p>
        <p>Answer:
          {% for answer in object.user_answers.all %}
            {% if answer.question == question %}
              {{ answer.text }} &#9989;
            {% endif %}
          {% endfor %}
        </p>
      </li>
      <hr>
    {% endfor %}
  </ul>
<br>
  <h3>Unanswered or incorrectly answered questions:</h3>
  <ul>
    {% for question in object.quiz.questions.all %}
      {% if question not in object.questions_attempted.all %}
        <li>
            <p>Question: {{ question.text|safe }}</p>
            <p>Correct answer:
                {% for answer in question.answers.all %}
                    {% if answer.correct %}
                        {{ answer.text }}
                    {% endif %}
                {% endfor %}
            </p>
            <p>Your answer:
                {% for answer in object.user_incorrect_answers.all %}
                    {% if answer.question == question %}
                        {{ answer.text }} &#10060;
                    {% comment %} elif logic when question was unanswered {% endcomment %}
                    {% endif %}
                {% endfor %}
            </p>
        </li>
        <hr>
      {% endif %}
    {% endfor %}
  </ul>
  
{% endblock content %}